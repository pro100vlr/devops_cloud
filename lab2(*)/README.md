## Лабораторная работа(*) №2

Выполнила: Просветова Валерия K3241

# Docker Compose: плохой и хороший пример

## Плохие практики в `docker-compose.bad.yml`

| № | Плохая практика | Почему плохо | Как исправлено |
|---|------------------|--------------|----------------|
| 1 | Использование `latest` тега | При обновлении образа может внезапно измениться поведение контейнера, нарушить совместимость или вызвать ошибки. | Указаны конкретные версии образов (`nginx:1.25.4`, `postgres:16.2`). Это делает окружение воспроизводимым. |
| 2 | Запуск контейнера от `root` | Контейнер, работающий от root, может быть уязвим для атак, особенно при монтировании директорий хоста. | Установлен непривилегированный пользователь (`user: "1001:1001"`). Это снижает риск компрометации системы. |
| 3 | Все сервисы в одной сети | По умолчанию контейнеры могут обращаться друг к другу по DNS-именам, что нарушает принцип минимизации доступов. | Созданы отдельные сети (`web_net` и `db_net`), обеспечивающие сетевую изоляцию между сервисами. |

Как исправление повлияло на результат: 
* Сильные пароли и отдельная сеть уменьшили риск несанкционированного доступа. 
* Разделение сетей позволило сделать контейнер доступным только для нужных сервисов. 
* Контейнеры стали более изолированными и предсказуемыми, что повышает надёжность и безопасность всего приложения.

---

## Изоляция контейнеров

Чтобы контейнеры **поднимались вместе, но не видели друг друга**,  
мы создали **две разные сети**:

```yaml
networks:
  web_net:
    driver: bridge
  db_net:
    driver: bridge
```

В обновлённой конфигурации для каждого контейнера создана отдельная сеть (web_net и db_net), благодаря чему они поднимаются вместе, но не имеют общего сетевого пространства и не могут обращаться друг к другу. Такая изоляция достигается за счёт того, что каждая сеть типа bridge в Docker представляет собой отдельный виртуальный коммутатор, и контейнеры, подключённые к разным сетям, получают IP-адреса из разных подсетей без маршрутов между ними. Это обеспечивает сетевую независимость и повышает безопасность проекта.

Добавлю скриншоты к отчету:

Запуск плохого докер compose файла:

<img width="1875" height="833" alt="image (9)" src="https://github.com/user-attachments/assets/4dc1bfe8-a07b-42b2-9b1a-d4cbea8f0a08" />

Проверяю, что оба контейнера запущены:

<img width="1847" height="143" alt="image (10)" src="https://github.com/user-attachments/assets/a51ef81a-fc25-4f7f-b879-f6e35c47816a" />

Nginx успешно работает в обоих случаях (скрин будет один и тот же для обоих файлов):

<img width="1915" height="692" alt="image (11)" src="https://github.com/user-attachments/assets/4186fd4a-f85b-497d-8d98-dfe878f390a4" />

Останавливаю плохой проект:

<img width="1884" height="207" alt="image (12)" src="https://github.com/user-attachments/assets/f1dcab86-465c-4935-aaee-5d616fb52e4b" />

Заупск хорошего докер проекта и проверка, что оба контейнера запущены:

<img width="1884" height="863" alt="image (13)" src="https://github.com/user-attachments/assets/9ed98032-f6a5-446a-8d46-a60c0fa82c70" />

Проверка изоляции контейнеров (каждый контейнер внутри своей сети):

<img width="1827" height="187" alt="image (14)" src="https://github.com/user-attachments/assets/64910f06-e7be-4c1c-a651-b0367d7442fa" />


Вывод:

В ходе работы были рассмотрены и исправлены плохие практики при написании Docker Compose файла. После внесённых изменений проект стал более безопасным, стабильным и предсказуемым, а также обеспечена сетовая изоляция контейнеров, что повысило уровень защиты и управляемости системы.
